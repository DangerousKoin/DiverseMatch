(this.webpackJsonpdiversematch=this.webpackJsonpdiversematch||[]).push([[0],{150:function(e,t,n){},151:function(e,t,n){},159:function(e,t,n){},160:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(0),c=n(56),s=n.n(c),o=(n(149),n(150),n(10)),i=n(11),l=(n(151),n(24)),u=n.n(l),j=n(39),h=n(35),d=n(29);function b(e){return Object(a.jsx)("span",{className:"error",children:e.error})}var p=n(179),O=n(178),m=n(131),f=n(173),x=n(180),g=n(176);function v(){var e=localStorage.getItem("token");e&&(JSON.parse(atob(e.split(".")[1])).exp<Date.now()/1e3&&(localStorage.removeItem("token"),e=null));return e}var w={setToken:function(e){e?localStorage.setItem("token",e):localStorage.removeItem("token")},getToken:v,removeToken:function(){localStorage.removeItem("token")},getUserFromToken:function(){var e=v();return e?JSON.parse(atob(e.split(".")[1])).user:null}},S="/api/users/";var k={signup:function(e){return fetch(S+"signup",{method:"POST",body:e}).then((function(e){if(e.ok)return e.json();throw new Error("Username already taken!")})).then((function(e){var t=e.token;return w.setToken(t)}))},getUser:function(){return w.getUserFromToken()},logout:function(){w.removeToken()},login:function(e){return fetch(S+"login",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(e)}).then((function(e){if(e.ok)return e.json();throw new Error("Bad Credentials!")})).then((function(e){var t=e.token;return w.setToken(t)}))},getProfile:function(e){return fetch(S+e,{headers:{Authorization:"Bearer "+w.getToken()}}).then((function(e){if(e.ok)return e.json();throw new Error("User does not exist")}))}};function y(e){var t=Object(r.useState)(!1),n=Object(o.a)(t,2),c=n[0],s=(n[1],Object(r.useState)("")),l=Object(o.a)(s,2),v=l[0],w=l[1],S=Object(r.useState)(""),y=Object(o.a)(S,2),C=y[0],T=y[1],P=Object(r.useState)({username:"",password:"",passwordConf:""}),A=Object(o.a)(P,2),I=A[0],L=A[1],N=Object(i.g)();function U(e){L(Object(d.a)(Object(d.a)({},I),{},Object(h.a)({},e.target.name,e.target.value)))}function D(){return(D=Object(j.a)(u.a.mark((function t(n){var a,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in n.preventDefault(),(a=new FormData).append("photo",C),I)a.append(r,I[r]);return t.prev=4,t.next=7,k.signup(a);case 7:e.handleSignUpOrLogin(),N.push("/"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(4),console.log(t.t0.message),w(t.t0.message);case 15:case"end":return t.stop()}}),t,null,[[4,11]])})))).apply(this,arguments)}return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(p.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(a.jsxs)(p.a.Column,{style:{maxWidth:450},children:[Object(a.jsxs)(O.a,{as:"h2",color:"teal",textAlign:"center",children:[Object(a.jsx)(m.a,{src:"https://photocollector.s3-us-west-2.amazonaws.com/site-images/DiverseMatch_logo.png"})," Sign Up"]}),Object(a.jsxs)(f.a,{autoComplete:"off",onSubmit:function(e){return D.apply(this,arguments)},children:[Object(a.jsxs)(x.a,{stacked:!0,children:[Object(a.jsx)(f.a.Input,{name:"username",placeholder:"username",value:I.username,onChange:U,required:!0}),Object(a.jsx)(f.a.Input,{name:"password",type:"password",placeholder:"password",value:I.password,onChange:U,required:!0}),Object(a.jsx)(f.a.Input,{name:"passwordConf",type:"password",placeholder:"Confirm Password",value:I.passwordConf,onChange:U,required:!0}),Object(a.jsx)(f.a.Field,{children:Object(a.jsx)(f.a.Input,{type:"file",name:"photo",placeholder:"upload image",onChange:function(e){T(e.target.files[0])}})}),Object(a.jsx)(g.a,{type:"submit",className:"btn",disabled:c,children:"Signup"})]}),v?Object(a.jsx)(b,{error:v}):null]})]})})})}n(159);var C=n(31),T=n(175);function P(e){var t=Object(r.useState)(!1),n=Object(o.a)(t,2),c=n[0],s=(n[1],Object(r.useState)("")),l=Object(o.a)(s,2),v=l[0],w=l[1],S=Object(r.useState)({username:"",password:""}),y=Object(o.a)(S,2),P=y[0],A=y[1],I=Object(i.g)();function L(e){A(Object(d.a)(Object(d.a)({},P),{},Object(h.a)({},e.target.name,e.target.value)))}function N(){return(N=Object(j.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,k.login(P);case 4:e.handleSignUpOrLogin(),I.push("/"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),w(t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(p.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(a.jsxs)(p.a.Column,{style:{maxWidth:450},children:[Object(a.jsxs)(O.a,{as:"h2",color:"teal",textAlign:"center",children:[Object(a.jsx)(m.a,{src:"https://photocollector.s3-us-west-2.amazonaws.com/site-images/DiverseMatch_logo.png"})," Log-in to your account"]}),Object(a.jsx)(f.a,{autoComplete:"off",onSubmit:function(e){return N.apply(this,arguments)},children:Object(a.jsxs)(x.a,{stacked:!0,children:[Object(a.jsx)(f.a.Input,{name:"username",placeholder:"username",value:P.username,onChange:L,requiredss:!0}),Object(a.jsx)(f.a.Input,{name:"password",type:"password",placeholder:"password",value:P.password,onChange:L,required:!0}),Object(a.jsx)(g.a,{color:"teal",fluid:!0,size:"large",type:"submit",className:"btn",disabled:c,children:"Login"})]})}),Object(a.jsxs)(T.a,{children:["New to us? ",Object(a.jsx)(C.b,{to:"/signup",children:"Sign Up"})]}),v?Object(a.jsx)(b,{error:v}):null]})})})}var A=n(84),I=n(172);function L(e){var t=e.user;return Object(a.jsx)(p.a,{textAlign:"center",columns:2,children:Object(a.jsxs)(p.a.Row,{children:[Object(a.jsx)(p.a.Column,{children:Object(a.jsx)(m.a,{src:"".concat(t.avatar?t.avatar:"https://react.semantic-ui.com/images/wireframe/square-image.png"," "),avatar:!0,size:"small"})}),Object(a.jsxs)(p.a.Column,{textAlign:"left",style:{maxWidth:450},children:[Object(a.jsx)(x.a,{vertical:!0,children:Object(a.jsx)("h3",{children:t.username})}),Object(a.jsx)(x.a,{children:Object(a.jsxs)("span",{children:[" Bio: ",t.bio]})})]})]})})}var N=n(174);var U=function(e){var t=e.topic;return Object(a.jsxs)(N.a,{children:[Object(a.jsxs)(N.a.Content,{textAlign:"left",children:[Object(a.jsxs)(N.a.Header,{floated:"right",children:["Topic: ",t.title]}),Object(a.jsx)(m.a,{floated:"left",size:"large",src:t.icon?t.icon:"https://react.semantic-ui.com/images/wireframe/square-image.png"})]}),Object(a.jsx)(N.a.Content,{children:Object(a.jsx)(N.a.Description,{children:t.description})})]},t._id)};function D(e){var t=e.topics,n=e.isProfile,r=e.numPhotosCol,c=e.user;return Object(a.jsx)(N.a.Group,{itemsPerRow:r,stackable:!0,children:t.map((function(e){return Object(a.jsx)(U,{topic:e,isProfile:n,user:c},e._id)}))})}var q={search:function(e){return fetch("".concat("/","search?=").concat(e),{method:"POST"})}};function F(){var e=Object(r.useState)({}),t=Object(o.a)(e,2),n=t[0],c=t[1],s=[];return Object(a.jsxs)(x.a,{children:[Object(a.jsxs)(f.a,{autoComplete:"off",onSubmit:function(e){e.preventDefault(),(new FormData).append("title",n.title),s=q.search(n.title),console.log("component results ",s)},children:[Object(a.jsx)(f.a.Input,{className:"search-input",name:"title",placeholder:"Search Topics",onChange:function(e){c(Object(d.a)(Object(d.a)({},n),{},Object(h.a)({},e.target.name,e.target.value)))},required:!0}),Object(a.jsx)(g.a,{type:"submit",className:"btn",children:"Search"})]}),Object(a.jsx)(N.a.Group,{stackable:!0,children:s.map((function(e){return Object(a.jsx)(U,{topic:e},e._id)}))})]})}var z=n(79);function R(e){var t=e.user,n=e.handleLogout;return Object(a.jsxs)(x.a,{clearing:!0,children:[Object(a.jsxs)(O.a,{as:"h2",floated:"right",children:[Object(a.jsx)(C.b,{to:"/",children:Object(a.jsx)(z.a,{name:"home"})}),Object(a.jsx)(C.b,{to:"",onClick:n,children:"Logout"})]}),Object(a.jsx)(O.a,{as:"h2",floated:"left",children:Object(a.jsx)(C.b,{to:"/".concat(t.username),children:Object(a.jsx)(m.a,{src:t.avatar?t.avatar:"https://react.semantic-ui.com/images/wireframe/square-image.png",avatar:!0})})})]})}function W(e){var t=e.user,n=e.handleLogout,c=Object(r.useState)([]),s=Object(o.a)(c,2),l=s[0],h=s[1],d=Object(r.useState)({}),b=Object(o.a)(d,2),O=b[0],m=b[1],f=Object(r.useState)(!0),x=Object(o.a)(f,2),g=x[0],v=x[1],w=Object(r.useState)(""),S=Object(o.a)(w,2),y=(S[0],S[1]),C=Object(i.h)();function T(){return(T=Object(j.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=C.pathname.substring(1),console.log("ProfilePage username",t),e.next=5,k.getProfile(t);case 5:n=e.sent,console.log("ProfilePage data",n),v((function(){return!1})),h((function(){return Object(A.a)(n.topics)})),m((function(){return n.user})),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0),y(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return console.log(C),Object(r.useEffect)((function(){!function(){T.apply(this,arguments)}()}),[]),Object(a.jsx)(a.Fragment,{children:g?Object(a.jsx)(p.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(a.jsx)(p.a.Column,{style:{maxWidth:450},children:Object(a.jsx)(I.a,{size:"large",active:!0,children:"Loading"})})}):Object(a.jsxs)(p.a,{children:[Object(a.jsx)(p.a.Row,{children:Object(a.jsx)(p.a.Column,{children:Object(a.jsx)(R,{user:t,handleLogout:n})})}),Object(a.jsx)(p.a.Row,{children:Object(a.jsx)(p.a.Column,{children:Object(a.jsx)(L,{user:O})})}),Object(a.jsx)(p.a.Row,{centered:!0,children:Object(a.jsx)(F,{})}),Object(a.jsx)(p.a.Row,{centered:!0,children:Object(a.jsx)(D,{isProfile:!0,topics:l,numPhotosCol:3,user:t})})]})})}function B(e){var t=Object(r.useState)(""),n=Object(o.a)(t,2),c=n[0],s=n[1],i=Object(r.useState)({description:""}),l=Object(o.a)(i,2),u=l[0],j=l[1];function b(e){j(Object(d.a)(Object(d.a)({},u),{},Object(h.a)({},e.target.name,e.target.value)))}return Object(a.jsx)(x.a,{children:Object(a.jsxs)(f.a,{autoComplete:"off",onSubmit:function(t){t.preventDefault();var n=new FormData;n.append("photo",c),n.append("description",u.description),n.append("title",u.title),e.handleAddTopic(n)},children:[Object(a.jsx)(f.a.Input,{className:"form-control",name:"title",value:u.title,placeholder:"topic title",onChange:b,required:!0}),Object(a.jsx)(f.a.Input,{className:"form-control",name:"description",value:u.description,placeholder:"topic description",onChange:b,required:!0}),Object(a.jsx)(f.a.Input,{className:"form-control",type:"file",name:"photo",placeholder:"upload image",onChange:function(e){s(e.target.files[0])}}),Object(a.jsx)(g.a,{type:"submit",className:"btn",children:"ADD TOPIC"})]})})}var E="/api/topics";function J(e){return fetch(E,{method:"POST",body:e,headers:{Authorization:"Bearer "+w.getToken()}}).then((function(e){return e.json()}))}function _(){return fetch(E,{headers:{Authorization:"Bearer "+w.getToken()}}).then((function(e){return e.json()}))}function G(e){var t=e.user,n=e.handleLogout,c=Object(r.useState)([]),s=Object(o.a)(c,2),i=s[0],l=s[1];function h(){return(h=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t);case 2:n=e.sent,console.log(n," data"),l([n.topic].concat(Object(A.a)(i)));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return(d=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_();case 3:t=e.sent,l(Object(A.a)(t.topics)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0," this is the error");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){!function(){d.apply(this,arguments)}()}),[]),Object(a.jsxs)(p.a,{centered:!0,children:[Object(a.jsx)(p.a.Row,{children:Object(a.jsx)(p.a.Column,{children:Object(a.jsx)(R,{user:t,handleLogout:n})})}),Object(a.jsx)(p.a.Row,{children:Object(a.jsx)(p.a.Column,{style:{maxWidth:450},children:Object(a.jsx)(B,{handleAddTopic:function(e){return h.apply(this,arguments)}})})}),Object(a.jsx)(p.a.Row,{children:Object(a.jsx)(p.a.Column,{style:{maxWidth:450},children:Object(a.jsx)(D,{topics:i,isProfile:!0,numPhotosCol:1,user:t})})})]})}var H=function(){var e=Object(r.useState)(k.getUser()),t=Object(o.a)(e,2),n=t[0],c=t[1];function s(){c(k.getUser())}function l(){k.logout(),c({user:null})}return Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(i.d,{children:[Object(a.jsx)(i.b,{exact:!0,path:"/login",children:Object(a.jsx)(P,{handleSignUpOrLogin:s})}),Object(a.jsx)(i.b,{exact:!0,path:"/signup",children:Object(a.jsx)(y,{handleSignUpOrLogin:s})}),k.getUser()?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(i.b,{exact:!0,path:"/",children:Object(a.jsx)(G,{user:n,handleLogout:l})}),Object(a.jsx)(i.b,{path:"/:username",children:Object(a.jsx)(W,{user:n,handleLogout:l})})]}):Object(a.jsx)(i.a,{to:"/login"})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(a.jsx)(C.a,{children:Object(a.jsx)(H,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[160,1,2]]]);
//# sourceMappingURL=main.54237ee8.chunk.js.map